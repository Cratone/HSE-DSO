# STRIDE — Recipe Box

| Поток/Элемент | Угроза (S/T/R/I/D/E) | Описание угрозы | Контроль | Ссылка на NFR | Проверка/Артефакт |
|---------------|-----------------------|------------------|----------|---------------|-------------------|
| F1 (login)    | S (Spoofing)          | Подмена личности при логине | Argon2id, rate-limit на логин, стандартные ошибки без утечек | NFR-01, NFR-06, NFR-04 | Юнит‑тест argon2id; негативный тест rate‑limit; контракт‑тест 401 |
| F1/F5         | I (Information)       | Утечка токена в ответах/логах | Не логировать PII/tokens; выдача JWT только по HTTPS | NFR-07, NFR-02 | Греп логов; e2e: отсутствует токен в логах |
| F6 (CRUD)     | R (Repudiation)       | Отрицание действий пользователем | correlation_id + структурные логи | NFR-07 | Логи содержат correlation_id ≥95% |
| F6/F7         | T (Tampering)         | Изменение чужих рецептов (IDOR) | Owner‑only проверки в сервисе, игнор client‑userId | NFR-03 | E2E негатив на 403/404 для чужих ресурсов |
| F6            | D (DoS)               | Заливка write‑запросами        | Rate limiting на write‑эндпоинтах | NFR-06 | Интеграционный тест: 429 при >100 req/min |
| F8            | T (Tampering)         | Некорректные units ломают логику | Валидация белого списка units      | NFR-05 | Интеграционные/юнит‑тесты 422 |
| DB (данные)   | E (Elevation)         | Эксплойт уязвимых зависимостей | Регулярный SCA и фиксы ≤7 дней     | NFR-09 | CI отчёт pip‑audit/safety |
| F6 (search)   | D (DoS)/P (Perf)      | Долгие запросы поиска           | Индексы/оптимизация, целевой p95   | NFR-08 | Отчёт нагрузочного теста p95 ≤200ms |
| API           | I (Info Disclosure)   | Детали ошибок раскрывают систему | Единый конверт ошибок, без стеков  | NFR-04 | Контракт‑тесты 4xx/5xx |
| API           | T (Tampering)         | Переполнение/большие тела       | Ограничения размеров входа         | NFR-10 | Интеграционные тесты границ |
